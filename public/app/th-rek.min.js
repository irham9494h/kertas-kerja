const tahunUrl=window.location.origin+"/tahun-rekening/",confirmDelete={title:"Apakah Anda yakin?",text:"Data yang telah dihapus tidak dapat dikembalikan!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus sekarang!",cancelButtonText:"Tidak, batal hapus!",reverseButtons:!0};let tahun=0;const confirmActivate={title:"Apakah Anda yakin?",text:"Anda akan mengaktifkan tahun rekening "+tahun+" yang akan menon-aktifkan tahun rekening yang lain.",type:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, aktifkan sekarang!",cancelButtonText:"Tidak, batal aktifkan!",reverseButtons:!0};function successSwal(a){return Swal.fire("Berhasil!",a,"success")}function showError(a,n){$.each(a,function(a,t){$("#"+n).find($("input[name="+a+"]")).addClass("is-invalid"),$("#"+n).find($("#"+a+"_feedback")).text(t)})}function fecthTahun(){$.ajax({type:"GET",url:tahunUrl+"fetch",dataType:"json",success:function(a){var n="";if($("#tableTahunRekeningBody").html(""),a.data.length>0){for(var t=0;t<a.data.length;t++)n+='<tr id="rowTahunRekening'+a.data[t].id+'">',n+='<td id="rowTahun'+a.data[t].id+'">'+a.data[t].tahun+"</td>",null!==a.data[t].deskripsi?n+='<td id="rowDeskripsi'+a.data[t].id+'">'+a.data[t].deskripsi+"</td>":n+='<td id="rowDeskripsi'+a.data[t].id+'">-</td>',1===a.data[t].status?n+='<td id="rowStatus'+a.data[t].id+'"><span class="badge badge-info">Aktif</span></td>':n+='<td id="rowStatus'+a.data[t].id+'"><span class="badge badge-dark">Tidak Aktif</span></td>',n+="<td>",n+='<div class="btn-group btn-group-xs">',n+='<button class="btn btn-outline-primary btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-bars"></i></button>',n+='<div class="dropdown-menu dropdown-menu-right">',0===a.data[t].status&&(n+='<button class="dropdown-item" type="button" id="btnactivateTahunRekening" data-id="'+a.data[t].id+'" onclick="activateTahunRekening('+a.data[t].id+')">Aktifkan</button>'),n+='<button class="dropdown-item" type="button" id="btnHapusTahunRekening" data-id="'+a.data[t].id+'" onclick="deleteTahunRekening('+a.data[t].id+')">Hapus</button>',n+="</div></div>",n+="</td>",n+="</tr>";$("#tableTahunRekeningBody").html(n)}else $("#tableTahunRekeningBody").html('<tr><td colspan="3" class="text-center">tidak ada data</td></tr>')}})}function editTahunRekening(a){console.log(a)}function deleteTahunRekening(a){Swal.fire(confirmDelete).then(n=>{n.value&&$.ajax({type:"GET",url:tahunUrl+"delete/"+a,dataType:"json",success:function(n){n.status&&(fecthTahun(),successSwal("Berhasil menghapus data tahun rekening."),$("#rowTahunRekening"+a).remove())}})})}function activateTahunRekening(a){tahun=$("#rowTahun"+a).text(),Swal.fire(confirmActivate).then(n=>{n.value&&$.ajax({type:"PUT",url:tahunUrl+"activate/"+a,dataType:"json",success:function(a){a.status&&(fecthTahun(),successSwal("Berhasil mengaktifkan data tahun rekening."))}})})}$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#btnTambahTahunRekening").on("click",function(a){a.preventDefault(),$("#modalFormTahunRekening").text("Form Tambah Tahun Rekening"),$("#btnSimpanTahunRekening").show(),$("#btnSimpanUbahTahunRekening").hide(),$("#formTahunRekening").trigger("reset"),$("#modalTahunRekening").modal("show")}),$("#btnSimpanTahunRekening").on("click",function(a){a.preventDefault();$.ajax({type:"POST",url:tahunUrl+"store",dataType:"json",data:$("#formTahunRekening").serialize(),success:function(a){a.status?($("#modalTahunRekening").modal("hide"),fecthTahun(),successSwal("Berhasil menambah data tahun rekening.")):showError(a.error,"formTahunRekening")}})}),$("#btnSimpanUbahTahunRekening").on("click",function(a){a.preventDefault();$.ajax({type:"PUT",url:sbThnUrl+"update/"+$("#tahunId").val(),dataType:"json",data:$("#formKertasKerja").serialize(),success:function(a){a.status?($("#modalKertasKerja").modal("hide"),fecthTahun(),successSwal("Berhasil menambah data urusan.")):showError(a.error,"formKertasKerja")}})})});
