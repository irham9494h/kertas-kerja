const sbThnUrl=window.location.origin+"/sb/t/",confirmDelete={title:"Apakah Anda yakin?",text:"Data yang telah dihapus tidak dapat dikembalikan!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus sekarang!",cancelButtonText:"Tidak, batal hapus!",reverseButtons:!0},lockWarningMessage="STRUKTUR MURNI SUDAH TERKUNCI, Anda tidak dapat menghapus tahun pembahasan.";function successSwal(a){return Swal.fire("Berhasil!",a,"success")}function showError(a,t){$.each(a,function(a,e){$("#"+t).find($("input[name="+a+"]")).addClass("is-invalid"),$("#"+t).find($("#"+a+"_feedback")).text(e)})}function warningSwal(a){return Swal.fire("Peringatan!",a,"warning")}function fecthTahun(){$.ajax({type:"GET",url:sbThnUrl+"fetch-tahun",dataType:"json",success:function(a){var t="";if(a.data.length>0){for(var e=0;e<a.data.length;e++)t+='<tr id="rowKertasKerja'+a.data[e].id+'">',t+='<td id="rowTahun'+a.data[e].id+'">'+a.data[e].tahun+"</td>",0==a.data[e].status_murni?t+='<td id="rowStatus'+a.data[e].id+'"><span class="badge badge-info">Terbuka</span></td>':t+='<td id="rowStatus'+a.data[e].id+'"><span class="badge badge-warning">Terkunci</span></td>',null!==a.data[e].deskripsi?t+='<td id="rowDeskripsi'+a.data[e].id+'">'+a.data[e].deskripsi+"</td>":t+='<td id="rowDeskripsi'+a.data[e].id+'">-</td>',t+="<td>",t+='<div class="btn-group btn-group-xs">',t+='<input type="hidden" value="'+a.data[e].status_murni+'" id="statusMurni'+a.data[e].id+'">',t+='<button class="btn btn-outline-primary btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-bars"></i></button>',t+='<div class="dropdown-menu dropdown-menu-right">',t+='<a href="'+sbThnUrl+a.data[e].id+'/kertas-kerja/murni" class="dropdown-item" type="button">Struktur Murni</a>',t+='<a href="'+sbThnUrl+a.data[e].id+'/kertas-kerja/perubahan" class="dropdown-item" type="button">Struktur Perubahan</a>',t+='<button class="dropdown-item" type="button" id="btnHapusKertasKerja" data-id="'+a.data[e].id+'" onclick="deleteKertasKerja('+a.data[e].id+')">Hapus</button>',t+="</div></div>",t+="</td>",t+="</tr>";$("#tableKertasKerjaBody").html(t)}else $("#tableKertasKerjaBody").html('<tr><td colspan="3" class="text-center">tidak ada data</td></tr>')}})}function deleteKertasKerja(a){if(1==$("#statusMurni"+a).val())return warningSwal(lockWarningMessage),!1;Swal.fire(confirmDelete).then(t=>{t.value&&$.ajax({type:"GET",url:sbThnUrl+"delete/"+a,dataType:"json",success:function(a){a.status&&(fecthTahun(),successSwal("Berhasil menghapus data kertas kerja."))}})})}$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#btnTambahKertasKerja").on("click",function(a){a.preventDefault(),$("#modalFormKertasKerja").text("Form Tambah Kertas Kerja"),$("#btnSimpanKertasKerja").show(),$("#btnSimpanUbahKertasKerja").hide(),$("#formKertasKerja").trigger("reset"),$("#modalKertasKerja").modal("show")}),$("#btnSimpanKertasKerja").on("click",function(a){a.preventDefault();$.ajax({type:"POST",url:sbThnUrl+"store",dataType:"json",data:$("#formKertasKerja").serialize(),success:function(a){a.status?($("#modalKertasKerja").modal("hide"),fecthTahun(),successSwal("Berhasil menambah data urusan.")):showError(a.error,"formKertasKerja")}})})});
