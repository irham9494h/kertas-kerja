const sbTgl=window.location.origin+"/sb-tgl/",sbUrl=window.location.origin+"/kertas-kerja/",pendapatanUrl=window.location.origin+"/sb-tgl/pendapatan/",belanjaUrl=window.location.origin+"/sb-tgl/belanja/",confirmDelete={title:"Apakah Anda yakin?",text:"Data yang telah dihapus tidak dapat dikembalikan dan Anda akan kehilangan HISTORY dari kertas kerja Anda!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus sekarang!",cancelButtonText:"Tidak, batal hapus!",reverseButtons:!0};let oldNominal=0,tanggalKertasKerja=0,tanggalIDKertasKerja=0;function successSwal(a){return Swal.fire("Berhasil!",a,"success")}function errorSwal(a){return Swal.fire("Gagal!",a,"error")}function showError(a,e){$.each(a,function(a,t){$("#"+e).find($("input[name="+a+"]")).addClass("is-invalid"),$("#"+e).find($("#"+a+"_feedback")).text(t)})}function myDateFormat(a){var e=new Date(a.toString().split("/").reverse().join("-"));return("0"+e.getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+e.getFullYear()}function formatRupiah(a){return AutoNumeric.format(a,{digitGroupSeparator:".",decimalCharacter:",",decimalCharacterAlternative:"."})}function deleteTanggalKertasKerja(a){Swal.fire(confirmDelete).then(e=>{e.value&&$.ajax({type:"GET",url:sbTgl+"delete/"+a,dataType:"json",success:function(e){e.status?(successSwal(e.message),$(".btn-kertas-kerja-g:nth-last-of-type(2)").append('<button type="button" class="btn btn-xs btn-outline-danger" id="btnDeleteTanggal" onclick="deleteTanggalKertasKerja('+$(".btn-kertas-kerja-g:nth-last-of-type(2)").data("tanggal-id")+')"><i class="fa fa-times"></i></button>'),$("#tglKertasKerja"+a).remove()):errorSwal(e.message)}})})}$(function(){$("#tanggal").daterangepicker({singleDatePicker:!0,showDropdowns:!0,locale:{format:"DD/MM/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",fromLabel:"From",toLabel:"To",customRangeLabel:"Custom",weekLabel:"W",daysOfWeek:["Ming","Sen","Sel","Rab","Kam","Jum","Sab"],monthNames:["Januari","Februari","Maret","April","Mei","Juni","Juli","Augustus","September","Oktober","November","Desember"],firstDay:1}}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#btnTambahSbTanggal").on("click",function(a){a.preventDefault(),$("#modalFormTanggal").text("Form Tambah Kertas Kerja"),$("#btnSimpanTanggal").show(),$("#btnSimpanUbahTanggal").hide(),$("#tahunId").val($(this).data("tahun-id")),$("#modalTanggal").modal("show")}),$("#btnSimpanTanggal").on("click",function(a){a.preventDefault();var e="";$.ajax({type:"POST",url:sbTgl+"store",dataType:"json",data:$("#formTanggal").serialize(),success:function(a){console.log(a),a.status?($("#btnDeleteTanggal").remove(),e="",e+=' <div class="btn-group btn-group-xs" role="group" id="tglKertasKerja'+a.data.id+'">',e+='<a href="'+window.location.origin+"/sb/t/"+a.data.sd_tahun_id+"/kertas-kerja/d/"+a.data.id+'/list" class="btn btn-xs btn-outline-dark btn-kertas-kerja" id="btnFetchKertasKerja'+a.data.id+'">'+myDateFormat(a.data.tanggal)+"</a>",e+='<button type="button" class="btn btn-xs btn-outline-danger" id="btnDeleteTanggal" data-tanggal-id="'+a.data.id+'" onclick="deleteTanggalKertasKerja('+a.data.id+')"><i class="fa fa-times"></i></button>',e+="</div>",$("#buttonBar").append(e),successSwal("Berhasil menambah tanggal kertas kerja."),$("#modalTanggal").modal("hide")):showError(a.error,"formTanggal")},error:function(a){errorSwal(a.responseJSON.message)}},"json")})});
