const akunUrl=window.location.origin+"/rekening/akun/",kelompokUrl=window.location.origin+"/rekening/kelompok/",jenisUrl=window.location.origin+"/rekening/jenis/",objekUrl=window.location.origin+"/rekening/objek/";var user={},akun={},kelompok={},jenis={};const confirmDelete={title:"Apakah Anda yakin?",text:"Data yang telah dihapus tidak dapat dikembalikan!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus sekarang!",cancelButtonText:"Tidak, batal hapus!",reverseButtons:!0};function successSwal(a){return Swal.fire("Berhasil!",a,"success")}function showError(a,e){$.each(a,function(a,t){$("#"+e).find($("input[name="+a+"]")).addClass("is-invalid"),$("#"+e).find($("#"+a+"_feedback")).text(t)})}function editAkun(a){$("#modalFormAkun").text("Form Ubah Akun"),$("#btnSimpanAkun").hide(),$("#btnSimpanUbahAkun").show(),$("#formAkun").trigger("reset"),$.ajax({type:"GET",url:akunUrl+"show/"+a,dataType:"json",success:function(a){$("#kodeAkun").val(a.data.kode),$("#namaAkun").val(a.data.nama_akun),$("#aliasAkun").val(a.data.alias),$("#akunId").remove(),$("#formAkun").append('<input type="hidden" name="akun_id" id="akunId" value="'+a.data.id+'"/>')}}),$("#modalAkun").modal("show")}function updateAkun(a){a.preventDefault(),$.ajax({type:"PUT",url:akunUrl+"update/"+$("#akunId").val(),dataType:"json",data:$("#formAkun").serialize(),success:function(a){a.status?($("#modalAkun").modal("hide"),$.ajax({type:"GET",url:akunUrl+"show/"+$("#akunId").val(),dataType:"json",success:function(a){$("#rowKodeAkun"+a.data.id).text(a.data.kode),$("#rowNamaAkun"+a.data.id).text(a.data.nama_akun)}}),successSwal("Berhasil mengubah data akun.")):showError(a.error,"formAkun")}})}function deleteAkun(a){var e=$("#btnDeleteAkun"+a).data("delete-url");Swal.fire(confirmDelete).then(t=>{t.value&&$.ajax({type:"GET",url:e,dataType:"json",success:function(e){successSwal("Data akun telah dihapus."),$("#rowAkun"+a).remove()}})})}function goToKelompokTab(a){$("#content-akun-tab").removeClass("active"),$("#akun").removeClass(["active show"]),$("#content-kelompok-tab").addClass("active"),$("#kelompok").addClass("active show"),getDataKelompok(a)}function getDataKelompok(a){var e="";$("#btnTambahKelompok").show(),$("#tableKelompok").hide(),$("#noDataKelompok").hide(),$("#kelompokLoader").append('<div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>'),$.ajax({type:"GET",url:kelompokUrl+"by-akun/"+a,dataType:"json",success:function(t){if($("#tableKelompokBody").html(""),e="",t.data.length>0){akun=t.data[0].akun;for(var o=0;o<t.data.length;o++)e+='<tr id="rowKelompok'+t.data[o].id+'">',e+="<td>"+t.data[o].akun.kode+"</td>",e+='<td id="rowKodeKelompok'+t.data[o].id+'">'+t.data[o].kode+"</td>",e+='<td><a href="#" id="rowNamaKelompok'+t.data[o].id+'" onclick="goToJenisTab(\''+t.data[o].id+"')\">"+t.data[o].nama_kelompok+"</a></td>","superadmin"===user.role&&(e+="<td>",e+='<button class="btn btn-xs btn-outline-warning" onclick="editKelompok(\''+t.data[o].id+'\')" id="btnEditKelompok'+t.data[o].id+'" data-update-url="" data-kelompok-id="'+t.data[o].id+'"><i class="fa fa-edit"></i></button> ',e+='<button class="btn btn-xs btn-outline-danger" id="btnDeleteKelompok'+t.data[o].id+'" data-delete-url="'+kelompokUrl+"delete/"+t.data[o].id+'" data-kelompok-id="'+t.data[o].id+'" onclick="deleteKelompok('+t.data[o].id+')"> <i class="fa fa-trash"></i></button>',e+="</td>"),e+="</tr>";$("#kelompokLoader").html(""),$("#tableKelompok").show(),$("#tableKelompokBody").html(e)}else $("#noDataKelompok").show(),$.ajax({type:"GET",url:akunUrl+"show/"+a,dataType:"json",success:function(a){akun=a.data}}),$("#kelompokLoader").html("")}})}function editKelompok(a){$("#modalFormKelompok").text("Form Ubah Kelompok"),$("#btnSimpanKelompok").hide(),$("#btnSimpanUbahKelompok").show(),$("#formKelompok").trigger("reset"),$.ajax({type:"GET",url:kelompokUrl+"show/"+a,dataType:"json",success:function(a){$("#akunId").val(akun.id),$("#akunKelompok").val(akun.kode+"..."+akun.nama_akun),$("#kodeKelompok").val(a.data.kode),$("#namaKelompok").val(a.data.nama_kelompok),$("#kelompokId").remove(),$("#formKelompok").append('<input type="hidden" name="kelompok_id" id="kelompokId" value="'+a.data.id+'"/>')}}),$("#modalKelompok").modal("show")}function updateKelompok(a){a.preventDefault(),$.ajax({type:"PUT",url:kelompokUrl+"update/"+$("#kelompokId").val(),dataType:"json",data:$("#formKelompok").serialize(),success:function(a){a.status?($("#modalKelompok").modal("hide"),$.ajax({type:"GET",url:kelompokUrl+"show/"+$("#kelompokId").val(),dataType:"json",success:function(a){$("#rowKodeKelompok"+a.data.id).text(a.data.kode),$("#rowNamaKelompok"+a.data.id).text(a.data.nama_kelompok)}}),successSwal("Berhasil mengubah data kelompok.")):showError(a.error,"formKelompok")}})}function deleteKelompok(a){var e=$("#btnDeleteKelompok"+a).data("delete-url");Swal.fire(confirmDelete).then(t=>{t.value&&$.ajax({type:"GET",url:e,dataType:"json",success:function(e){successSwal("Berhasil menghapus data kelompok"),$("#rowKelompok"+a).remove()}})})}function goToJenisTab(a){$("#content-kelompok-tab").removeClass("active"),$("#kelompok").removeClass(["active show"]),$("#content-jenis-tab").addClass("active"),$("#jenis").addClass("active show"),getDataJenis(a)}function getDataJenis(a){var e="";$("#btnTambahJenis").show(),$("#tableJenis").hide(),$("#noDataJenis").hide(),$("#jenisLoader").append('<div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>'),$.ajax({type:"GET",url:jenisUrl+"by-kelompok/"+a,dataType:"json",success:function(t){if($("#tableJenisBody").html(""),e="",t.data.length>0){kelompok=t.data[0].kelompok,akun=t.data[0].kelompok.akun;for(var o=0;o<t.data.length;o++)e+='<tr id="rowJenis'+t.data[o].id+'">',e+="<td>"+akun.kode+"</td>",e+="<td>"+kelompok.kode+"</td>",e+='<td id="rowKodeJenis'+t.data[o].id+'">'+t.data[o].kode+"</td>",e+='<td><a href="#" id="rowNamaJenis'+t.data[o].id+'" onclick="goToObjekTab(\''+t.data[o].id+"')\">"+t.data[o].nama_jenis+"</a></td>","superadmin"===user.role&&(e+="<td>",e+='<button class="btn btn-xs btn-outline-warning" onclick="editJenis(\''+t.data[o].id+'\')" id="btnEditJenis'+t.data[o].id+'" data-update-url="" data-jenis-id="'+t.data[o].id+'"><i class="fa fa-edit"></i></button> ',e+='<button class="btn btn-xs btn-outline-danger" id="btnDeleteJenis'+t.data[o].id+'" data-delete-url="'+jenisUrl+"delete/"+t.data[o].id+'" data-jenis-id="'+t.data[o].id+'" onclick="deleteJenis('+t.data[o].id+')"> <i class="fa fa-trash"></i></button>',e+="</td>"),e+="</tr>";$("#jenisLoader").html(""),$("#tableJenis").show(),$("#tableJenisBody").html(e)}else $("#noDataJenis").show(),$.ajax({type:"GET",url:kelompokUrl+"show/"+a,dataType:"json",success:function(a){kelompok=a.data,akun=a.data.akun}}),$("#jenisLoader").html("")}})}function editJenis(a){$("#modalFormJenis").text("Form Ubah Jenis"),$("#btnSimpanJenis").hide(),$("#btnSimpanUbahJenis").show(),$("#formJenis").trigger("reset"),$.ajax({type:"GET",url:jenisUrl+"show/"+a,dataType:"json",success:function(a){$("#kelompokId").val(kelompok.id),$("#kelompokJenis").val(kelompok.kode+"..."+kelompok.nama_kelompok),$("#kodeJenis").val(a.data.kode),$("#namaJenis").val(a.data.nama_jenis),$("#jenisId").remove(),$("#formJenis").append('<input type="hidden" name="jenis_id" id="jenisId" value="'+a.data.id+'"/>')}}),$("#modalJenis").modal("show")}function updateJenis(a){a.preventDefault(),$.ajax({type:"PUT",url:jenisUrl+"update/"+$("#jenisId").val(),dataType:"json",data:$("#formJenis").serialize(),success:function(a){a.status?($("#modalJenis").modal("hide"),$.ajax({type:"GET",url:jenisUrl+"show/"+$("#jenisId").val(),dataType:"json",success:function(a){$("#rowKodeJenis"+a.data.id).text(a.data.kode),$("#rowNamaJenis"+a.data.id).text(a.data.nama_jenis)}}),successSwal("Berhasil mengubah data jenis.")):showError(a.error,"formJenis")}})}function deleteJenis(a){var e=$("#btnDeleteJenis"+a).data("delete-url");Swal.fire(confirmDelete).then(t=>{t.value&&$.ajax({type:"GET",url:e,dataType:"json",success:function(e){successSwal("Berhasil menghapus data jenis"),$("#rowJenis"+a).remove()}})})}function goToObjekTab(a){$("#content-jenis-tab").removeClass("active"),$("#jenis").removeClass(["active show"]),$("#content-objek-tab").addClass("active"),$("#objek").addClass("active show"),getDataObjek(a)}function getDataObjek(a){var e="";$("#btnTambahObjek").show(),$("#tableObjek").hide(),$("#noDataObjek").hide(),$("#objekLoader").append('<div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>'),$.ajax({type:"GET",url:objekUrl+"by-jenis/"+a,dataType:"json",success:function(t){if($("#tableObjekBody").html(""),e="",t.data.length>0){jenis=t.data[0].jenis,kelompok=t.data[0].jenis.kelompok,akun=t.data[0].jenis.kelompok.akun;for(var o=0;o<t.data.length;o++)e+='<tr id="rowObjek'+t.data[o].id+'">',e+="<td>"+akun.kode+"</td>",e+="<td>"+kelompok.kode+"</td>",e+="<td>"+jenis.kode+"</td>",e+='<td id="rowKodeObjek'+t.data[o].id+'">'+t.data[o].kode+"</td>",e+='<td id="rowNamaObjek'+t.data[o].id+'">'+t.data[o].nama_obyek+"</td>","superadmin"===user.role&&(e+="<td>",e+='<button class="btn btn-xs btn-outline-warning" onclick="editObjek(\''+t.data[o].id+'\')" id="btnEditObjek'+t.data[o].id+'" data-update-url="" data-objek-id="'+t.data[o].id+'"><i class="fa fa-edit"></i></button> ',e+='<button class="btn btn-xs btn-outline-danger" id="btnDeleteObjek'+t.data[o].id+'" data-delete-url="'+objekUrl+"delete/"+t.data[o].id+'" data-objek-id="'+t.data[o].id+'" onclick="deleteObjek('+t.data[o].id+')"> <i class="fa fa-trash"></i></button>',e+="</td>"),e+="</tr>";$("#objekLoader").html(""),$("#tableObjek").show(),$("#tableObjekBody").html(e)}else $("#noDataObjek").show(),$.ajax({type:"GET",url:jenisUrl+"show/"+a,dataType:"json",success:function(a){jenis=a.data,kelompok=a.data.kelompok,akun=a.data.kelompok.akun}}),$("#objekLoader").html("")}})}function editObjek(a){$("#modalFormObjek").text("Form Ubah Objek"),$("#btnSimpanObjek").hide(),$("#btnSimpanUbahObjek").show(),$("#formObjek").trigger("reset"),$.ajax({type:"GET",url:objekUrl+"show/"+a,dataType:"json",success:function(a){$("#jeniskId").val(jenis.id),$("#jenisObjek").val(jenis.kode+"..."+jenis.nama_jenis),$("#kodeObjek").val(a.data.kode),$("#namaObjek").val(a.data.nama_obyek),$("#objekId").remove(),$("#formObjek").append('<input type="hidden" name="objek_id" id="objekId" value="'+a.data.id+'"/>')}}),$("#modalObjek").modal("show")}function updateObjek(a){a.preventDefault(),$.ajax({type:"PUT",url:objekUrl+"update/"+$("#objekId").val(),dataType:"json",data:$("#formObjek").serialize(),success:function(a){a.status?($("#modalObjek").modal("hide"),$.ajax({type:"GET",url:objekUrl+"show/"+$("#objekId").val(),dataType:"json",success:function(a){$("#rowKodeObjek"+a.data.id).text(a.data.kode),$("#rowNamaObjek"+a.data.id).text(a.data.nama_obyek)}}),successSwal("Berhasil mengubah data objek.")):showError(a.error,"formObjek")}})}function deleteObjek(a){var e=$("#btnDeleteObjek"+a).data("delete-url");Swal.fire(confirmDelete).then(t=>{t.value&&$.ajax({type:"GET",url:e,dataType:"json",success:function(e){successSwal("Berhasil menghapus data objek"),$("#rowObjek"+a).remove()}})})}$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({type:"GET",url:window.location.origin+"/api/user",success:function(a){user=a}}),$("#btnTambahAkun").on("click",function(a){a.preventDefault(),$("#modalFormAkun").text("Form Tambah Akun"),$("#btnSimpanUbahAkun").hide(),$("#btnSimpanAkun").show(),$("#formAkun").trigger("reset"),$("#modalAkun").modal("show")}),$("#btnSimpanAkun").on("click",function(a){a.preventDefault();var e="";$.ajax({type:"POST",url:akunUrl+"store",dataType:"json",data:$("#formAkun").serialize(),success:function(a){a.status?(e="",e='<tr id="rowAkun'+a.data.id+'"><td id="rowKodeAkun'+a.data.id+'">'+a.data.kode+'</td><td><a href="#" id="rowNamaAkun'+a.data.id+'" onclick="goToKelompokTab(\''+a.data.id+"')\">"+a.data.nama_akun+'</a></td><td><button class="btn btn-xs btn-outline-warning" onclick="editAkun(\''+a.data.id+'\')" data-update-url="'+akunUrl+"show/"+a.data.id+'" data-akun-id="'+a.data.id+'"><i class="fa fa-edit"></i></button> <button class="btn btn-xs btn-outline-danger" id="btnDeleteAkun'+a.data.id+'" onclick="deleteAkun('+a.data.id+')" data-delete-url="'+akunUrl+"delete/"+a.data.id+'" data-akun-id="'+a.data.id+'"><i class="fa fa-trash"></i></button></td></tr>',$("#tableAkun").prepend(e),successSwal("Berhasil menambah data akun."),$("#modalAkun").modal("hide")):showError(a.error,"formAkun")}})}),$("#btnTambahKelompok").on("click",function(a){a.preventDefault(),$("#modalFormKelompok").text("Form Tambah kelompok"),$("#btnSimpanUbahKelompok").hide(),$("#btnSimpanKelompok").show(),$("#formKelompok").trigger("reset"),$("#modalKelompok").modal("show"),$("#akunId").val(akun.id),$("#akunKelompok").val(akun.kode+"..."+akun.nama_akun)}),$("#btnSimpanKelompok").on("click",function(a){a.preventDefault();var e="";$.ajax({type:"POST",url:kelompokUrl+"store",dataType:"json",data:$("#formKelompok").serialize(),success:function(a){a.status?(e="",e='<tr id="rowKelompok'+a.data.id+'"><td>'+akun.kode+'</td><td id="rowKodeKelompok'+a.data.id+'">'+a.data.kode+'</td><td><a href="#" id="rowNamaKelompok'+a.data.id+'" onclick="goToJenisTab(\''+a.data.id+"')\">"+a.data.nama_kelompok+'</a></td><td><button class="btn btn-xs btn-outline-warning" onclick="editKelompok(\''+a.data.id+'\')" data-update-url="'+kelompokUrl+"show/"+a.data.id+'" data-kelompok-id="'+a.data.id+'"><i class="fa fa-edit"></i></button> <button class="btn btn-xs btn-outline-danger" id="btnDeleteKelompok'+a.data.id+'" onclick="deleteKelompok('+a.data.id+')" data-delete-url="'+kelompokUrl+"delete/"+a.data.id+'" data-kelompok-id="'+a.data.id+'"><i class="fa fa-trash"></i></button></td></tr>',$("#tableKelompokBody").prepend(e),successSwal("Berhasil menambah data kelompok."),$("#modalKelompok").modal("hide")):showError(a.error,"formKelompok")}})}),$("#btnTambahJenis").on("click",function(a){a.preventDefault(),$("#modalFormJenis").text("Form Tambah Jenis"),$("#btnSimpanUbahJenis").hide(),$("#btnSimpanJenis").show(),$("#formJenis").trigger("reset"),$("#modalJenis").modal("show"),$("#kelompokId").val(kelompok.id),$("#kelompokJenis").val(kelompok.kode+"..."+kelompok.nama_kelompok)}),$("#btnSimpanJenis").on("click",function(a){a.preventDefault();var e="";$.ajax({type:"POST",url:jenisUrl+"store",dataType:"json",data:$("#formJenis").serialize(),success:function(a){a.status?(e="",e='<tr id="rowJenis'+a.data.id+'"><td>'+akun.kode+"</td><td>"+kelompok.kode+'</td><td id="rowKodeJenis'+a.data.id+'">'+a.data.kode+'</td><td><a href="#" id="rowNamaJenis'+a.data.id+'" onclick="goToObjekTab(\''+a.data.id+"')\">"+a.data.nama_jenis+'</a></td><td><button class="btn btn-xs btn-outline-warning" onclick="editJenis(\''+a.data.id+'\')" data-update-url="'+jenisUrl+"show/"+a.data.id+'" data-jenis-id="'+a.data.id+'"><i class="fa fa-edit"></i></button> <button class="btn btn-xs btn-outline-danger" id="btnDeleteJenis'+a.data.id+'" onclick="deleteJenis('+a.data.id+')" data-delete-url="'+jenisUrl+"delete/"+a.data.id+'" data-jenis-id="'+a.data.id+'"><i class="fa fa-trash"></i></button></td></tr>',$("#tableJenisBody").prepend(e),successSwal("Berhasil menambah data jenis."),$("#modalJenis").modal("hide")):showError(a.error,"formJenis")}})}),$("#btnTambahObjek").on("click",function(a){a.preventDefault(),$("#modalFormObjek").text("Form Tambah Objek"),$("#btnSimpanUbahObjek").hide(),$("#btnSimpanObjek").show(),$("#formObjek").trigger("reset"),$("#modalObjek").modal("show"),$("#jenisId").val(jenis.id),$("#jenisObjek").val(jenis.kode+"..."+jenis.nama_jenis)}),$("#btnSimpanObjek").on("click",function(a){a.preventDefault();var e="";$.ajax({type:"POST",url:objekUrl+"store",dataType:"json",data:$("#formObjek").serialize(),success:function(a){a.status?(e="",e='<tr id="rowObjek'+a.data.id+'"><td>'+akun.kode+"</td><td>"+kelompok.kode+"</td><td>"+jenis.kode+'</td><td id="rowKodeObjek'+a.data.id+'">'+a.data.kode+'</td><td id="rowNamaObjek'+a.data.id+'">'+a.data.nama_obyek+'</td><td><button class="btn btn-xs btn-outline-warning" onclick="editObjek(\''+a.data.id+'\')" data-update-url="'+objekUrl+"show/"+a.data.id+'" data-objek-id="'+a.data.id+'"><i class="fa fa-edit"></i></button> <button class="btn btn-xs btn-outline-danger" id="btnDeleteObjek'+a.data.id+'" onclick="deleteObjek('+a.data.id+')" data-delete-url="'+objekUrl+"delete/"+a.data.id+'" data-objek-id="'+a.data.id+'"><i class="fa fa-trash"></i></button></td></tr>',$("#tableObjekBody").prepend(e),successSwal("Berhasil menambah data objek."),$("#modalObjek").modal("hide")):showError(a.error,"formObjek")}})})});
